# 🔄 Algorithm Flowchart - HL-HH-LH-LL Market Structure Analysis
## v2.0 - Multi-Level Entry Detection System

---

## 🚀 **MASTER ALGORITHM FLOWCHART**

```
┌─────────────────────────────────────────────────────────────────────┐
│                        🎯 MAIN ALGORITHM FLOW                      │
└─────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────┐
│                           📊 INITIALIZATION                        │
│ ┌─────────────────────────────────────────────────────────────────┐ │
│ │ • Set parameters (retest_threshold = 20%)                      │ │
│ │ • Initialize arrays and ranges                                 │ │
│ │ • Wait for first price movement                                │ │
│ └─────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────┐
│                        📈 CANDLE CLOSE EVENT                       │
└─────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
                        ┌───────────────────────┐
                        │   Is this tick or     │
                        │   candle close?       │
                        └─────────┬─────────────┘
                                  │
                           ┌──────┴──────┐
                        TICK│            │CLOSE
                            ▼            │
                    ┌─────────────┐      │
                    │   IGNORE    │      │
                    │ (Performance│      │
                    │ optimization)│      │
                    └─────────────┘      │
                                         ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    🔍 SWING POINT DETECTION                         │
│ ┌─────────────────────────────────────────────────────────────────┐ │
│ │ Current Price Analysis:                                         │ │
│ │ • Check if price creates new extreme (H or L)                  │ │
│ │ • Validate against existing ranges                             │ │
│ │ • Determine if retest criteria met (>20% of range)             │ │
│ └─────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
                        ┌───────────────────────┐
                        │   New extreme point   │
                        │   detected?           │
                        └─────────┬─────────────┘
                                  │
                           ┌──────┴──────┐
                         NO│            │YES
                           ▼            │
                    ┌─────────────┐      │
                    │  CONTINUE   │      │
                    │ MONITORING  │      │
                    └─────────────┘      │
                                         ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    ⚙️ SWING CLASSIFICATION                          │
└─────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
                        ┌───────────────────────┐
                        │  Compare with last    │
                        │  swing point          │
                        └─────────┬─────────────┘
                                  │
                                  ▼
                    ┌─────────────────────────────┐
                    │    CLASSIFICATION LOGIC     │
                    │                             │
                    │ If H > previous H → HH      │
                    │ If H < previous H → LH      │
                    │ If L > previous L → HL      │
                    │ If L < previous L → LL      │
                    │ Standalone points → H or L  │
                    └─────────┬───────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────────┐
│                     📝 ARRAY MANAGEMENT                             │
│ ┌─────────────────────────────────────────────────────────────────┐ │
│ │ • Add classified point to swing_array[]                        │ │
│ │ • Update current range {A, B}                                  │ │
│ │ • Check array size for memory optimization                     │ │
│ │ • Maintain pattern history for analysis                        │ │
│ └─────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    🔍 PATTERN RECOGNITION                           │
└─────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
                        ┌───────────────────────┐
                        │   Check array for     │
                        │   complete patterns   │
                        └─────────┬─────────────┘
                                  │
                                  ▼
                    ┌─────────────────────────────┐
                    │     PATTERN ANALYSIS        │
                    │                             │
                    │ [HL,HH,HL,HH] = Upswing ✅  │
                    │ [LH,LL,LH,LL] = Downswing ✅│
                    │ Incomplete = Continue...    │
                    └─────────┬───────────────────┘
                              │
                      ┌───────┴────────┐
                 INCOMPLETE│           │COMPLETE
                           ▼           │
                ┌─────────────────┐    │
                │   WAIT FOR      │    │
                │  MORE DATA      │    │
                └─────────────────┘    │
                           │           │
                           └───────────┼──► RETURN TO MONITORING
                                       │
                                       ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    🎯 STRUCTURE ANALYSIS                            │
└─────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
                        ┌───────────────────────┐
                        │  Analyze current      │
                        │  price vs range       │
                        └─────────┬─────────────┘
                                  │
                                  ▼
                    ┌─────────────────────────────┐
                    │       EVENT DETECTION       │
                    └─────────┬───────────────────┘
                              │
                    ┌─────────┼─────────┐
                    │         │         │
                    ▼         ▼         ▼
           ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
           │     BOS     │ │    ChoCH    │ │    SWEEP    │
           │  DETECTION  │ │  DETECTION  │ │  DETECTION  │
           └─────────────┘ └─────────────┘ └─────────────┘
                    │         │         │
                    └─────────┼─────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────────┐
│                      📊 EVENT PROCESSING                           │
└─────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
                        ┌───────────────────────┐
                        │   Update ranges and   │
                        │   prepare for next    │
                        │   pattern cycle       │
                        └─────────┬─────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────────┐
│                     🔄 LOOP CONTINUATION                            │
│ ┌─────────────────────────────────────────────────────────────────┐ │
│ │ • Generate alerts/signals                                       │ │
│ │ • Update visual display                                         │ │
│ │ • Log events for analysis                                       │ │
│ │ • Return to candle monitoring                                   │ │
│ └─────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
                        ┌───────────────────────┐
                        │    BACK TO MAIN       │
                        │   MONITORING LOOP     │
                        └───────────────────────┘
```

---

## 🎯 **MULTI-LEVEL ENTRY DETECTION FLOWCHART**

### **Entry Detection Master Flow**

```
┌─────────────────────────────────────────────────────────────────────┐
│                   🎯 MULTI-LEVEL ENTRY SYSTEM                      │
└─────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
                        ┌───────────────────────┐
                        │   Array A detects     │
                        │   ChoCH event?        │
                        └─────────┬─────────────┘
                                  │
                           ┌──────┴──────┐
                         NO│            │YES
                           ▼            │
                    ┌─────────────┐      │
                    │  CONTINUE   │      │
                    │ MONITORING  │      │
                    │   ARRAY A   │      │
                    └─────────────┘      │
                                         ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    🔧 INITIALIZE ARRAY B                           │
│ ┌─────────────────────────────────────────────────────────────────┐ │
│ │ • Create new EntryArray B                                       │ │
│ │ • Set range = {ChoCH_start, ChoCH_end}                         │ │
│ │ • Set original_direction = Array A trend                       │ │
│ │ • Set choch_direction = opposite direction                      │ │
│ │ • Add to active_entry_arrays[]                                  │ │
│ └─────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    🔍 ARRAY B MONITORING LOOP                      │
└─────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
                        ┌───────────────────────┐
                        │   For each active     │
                        │   Array B instance    │
                        └─────────┬─────────────┘
                                  │
                                  ▼
                        ┌───────────────────────┐
                        │   Price within        │
                        │   Array B range?      │
                        └─────────┬─────────────┘
                                  │
                           ┌──────┴──────┐
                         NO│            │YES
                           ▼            │
                    ┌─────────────┐      │
                    │   CLEAR     │      │
                    │   ARRAY B   │      │
                    │ (Out of range)│    │
                    └─────────────┘      │
                                         ▼
                        ┌───────────────────────┐
                        │   Continue tracking   │
                        │   micro-patterns      │
                        │   in Array B          │
                        └─────────┬─────────────┘
                                  │
                                  ▼
                        ┌───────────────────────┐
                        │   Array B has         │
                        │   complete pattern?   │
                        └─────────┬─────────────┘
                                  │
                           ┌──────┴──────┐
                         NO│            │YES
                           ▼            │
                    ┌─────────────┐      │
                    │  CONTINUE   │      │
                    │  BUILDING   │      │
                    │  PATTERN    │      │
                    └─────────────┘      │
                                         ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    🎯 ENTRY SIGNAL ANALYSIS                        │
└─────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
                        ┌───────────────────────┐
                        │   Analyze BOS         │
                        │   direction in        │
                        │   Array B             │
                        └─────────┬─────────────┘
                                  │
                                  ▼
                    ┌─────────────────────────────┐
                    │      DIRECTION CHECK        │
                    └─────────┬───────────────────┘
                              │
                    ┌─────────┼─────────┐
                    │         │         │
                    ▼         ▼         ▼
           ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
           │BOS matches  │ │BOS opposite │ │   NO BOS    │
           │ChoCH dir    │ │to ChoCH dir │ │  DETECTED   │
           │= REAL CHOCH │ │= SWEEP      │ │= WAIT MORE  │
           └─────────────┘ └─────────────┘ └─────────────┘
                    │         │         │
                    ▼         ▼         │
           ┌─────────────┐ ┌─────────────┐ │
           │ENTRY SIGNAL:│ │ENTRY SIGNAL:│ │
           │Enter NEW    │ │Enter ORIG   │ │
           │Direction    │ │Direction    │ │
           └─────────────┘ └─────────────┘ │
                    │         │         │
                    └─────────┼─────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────────┐
│                      📊 SIGNAL EXECUTION                           │
│ ┌─────────────────────────────────────────────────────────────────┐ │
│ │ • Generate entry signal                                         │ │
│ │ • Calculate position size                                       │ │
│ │ • Set stop loss based on structure                             │ │
│ │ • Clear completed Array B                                       │ │
│ │ • Continue monitoring other Array B instances                   │ │
│ └─────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
                        ┌───────────────────────┐
                        │    RETURN TO MAIN     │
                        │   MONITORING LOOP     │
                        └───────────────────────┘
```

---

## 🔍 **DETAILED SUB-FLOWCHARTS**

### **1. BOS Detection Flowchart**

```
┌─────────────────────────────────────────────────────────────────────┐
│                         🚀 BOS DETECTION                           │
└─────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
                        ┌───────────────────────┐
                        │   Complete pattern    │
                        │   detected?           │
                        └─────────┬─────────────┘
                                  │
                           ┌──────┴──────┐
                         NO│            │YES
                           ▼            │
                    ┌─────────────┐      │
                    │   RETURN    │      │
                    │   FALSE     │      │
                    └─────────────┘      │
                                         ▼
                        ┌───────────────────────┐
                        │   Check price vs      │
                        │   range boundaries    │
                        └─────────┬─────────────┘
                                  │
                                  ▼
                    ┌─────────────────────────────┐
                    │       BOUNDARY CHECK        │
                    │                             │
                    │ Upswing: Price > range.high │
                    │ Downswing: Price < range.low│
                    └─────────┬───────────────────┘
                              │
                      ┌───────┴────────┐
                  FALSE│              │TRUE
                       ▼              │
                ┌─────────────────┐    │
                │   NO BOS        │    │
                │   DETECTED      │    │
                └─────────────────┘    │
                                       ▼
                        ┌───────────────────────┐
                        │   🎯 BOS CONFIRMED    │
                        │                       │
                        │ • Update trend state  │
                        │ • Reset range         │
                        │ • Start new pattern   │
                        │ • Generate signal     │
                        └───────────────────────┘
```

### **2. ChoCH Detection Flowchart**

```
┌─────────────────────────────────────────────────────────────────────┐
│                        🔄 ChoCH DETECTION                          │
└─────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
                        ┌───────────────────────┐
                        │   Complete pattern    │
                        │   [HL,HH,HL,HH] or    │
                        │   [LH,LL,LH,LL]?      │
                        └─────────┬─────────────┘
                                  │
                           ┌──────┴──────┐
                         NO│            │YES
                           ▼            │
                    ┌─────────────┐      │
                    │   RETURN    │      │
                    │   FALSE     │      │
                    └─────────────┘      │
                                         ▼
                        ┌───────────────────────┐
                        │  Check for opposite   │
                        │  direction break      │
                        └─────────┬─────────────┘
                                  │
                                  ▼
                    ┌─────────────────────────────┐
                    │       DIRECTION CHECK       │
                    │                             │
                    │ Upswing + Price < i2 = ChoCH│
                    │ Downswing + Price > i2 = ChoCH│
                    └─────────┬───────────────────┘
                              │
                      ┌───────┴────────┐
                  FALSE│              │TRUE
                       ▼              │
                ┌─────────────────┐    │
                │   NO ChoCH      │    │
                │   DETECTED      │    │
                └─────────────────┘    │
                                       ▼
                        ┌───────────────────────┐
                        │  ⚠️ WAIT FOR RETEST   │
                        │                       │
                        │ • Monitor next swing  │
                        │ • Prepare for sweep   │
                        │   vs true ChoCH       │
                        └─────────┬─────────────┘
                                  │
                                  ▼
                        ┌───────────────────────┐
                        │   📊 RETEST RESULT    │
                        │                       │
                        │ Same direction = Sweep│
                        │ Opposite = True ChoCH │
                        └───────────────────────┘
```

### **3. Sweep Detection Flowchart**

```
┌─────────────────────────────────────────────────────────────────────┐
│                         ⚡ SWEEP DETECTION                         │
└─────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
                        ┌───────────────────────┐
                        │   Recent ChoCH        │
                        │   detected?           │
                        └─────────┬─────────────┘
                                  │
                           ┌──────┴──────┐
                         NO│            │YES
                           ▼            │
                    ┌─────────────┐      │
                    │   RETURN    │      │
                    │   FALSE     │      │
                    └─────────────┘      │
                                         ▼
                        ┌───────────────────────┐
                        │   Monitor next        │
                        │   market structure    │
                        │   event               │
                        └─────────┬─────────────┘
                                  │
                                  ▼
                    ┌─────────────────────────────┐
                    │      EVENT ANALYSIS         │
                    │                             │
                    │ Next event = BOS in         │
                    │ OPPOSITE direction?         │
                    └─────────┬───────────────────┘
                              │
                      ┌───────┴────────┐
                    NO│              │YES
                      ▼              │
               ┌─────────────────┐    │
               │   TRUE ChoCH    │    │
               │   CONFIRMED     │    │
               │                 │    │
               │ • Trend changed │    │
               │ • Update bias   │    │
               └─────────────────┘    │
                                       ▼
                        ┌───────────────────────┐
                        │  ⚡ SWEEP CONFIRMED   │
                        │                       │
                        │ • ChoCH was fake      │
                        │ • Original trend      │
                        │   continues           │
                        │ • Counter-trade setup │
                        └───────────────────────┘
```

---

## 🎯 **DECISION TREES**

### **Main Pattern Decision Tree**

```
                              📊 NEW SWING POINT
                                       │
                                       ▼
                          ┌─────────────────────────┐
                          │   What type of point?   │
                          └─────────┬───────────────┘
                                    │
                     ┌──────────────┼──────────────┐
                     │              │              │
                     ▼              ▼              ▼
              ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
              │   HIGH (H)  │ │   LOW (L)   │ │  UNCLEAR    │
              └─────────────┘ └─────────────┘ └─────────────┘
                     │              │              │
                     ▼              ▼              ▼
              ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
              │ Compare to  │ │ Compare to  │ │    WAIT     │
              │ previous H  │ │ previous L  │ │ FOR CLARITY │
              └─────────────┘ └─────────────┘ └─────────────┘
                     │              │
              ┌──────┴──────┐ ┌──────┴──────┐
              │             │ │             │
              ▼             ▼ ▼             ▼
       ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
       │  H > prev   │ │  H < prev   │ │  L > prev   │ │  L < prev   │
       │    = HH     │ │    = LH     │ │    = HL     │ │    = LL     │
       └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘
              │             │             │             │
              └─────────────┼─────────────┼─────────────┘
                            │             │
                            ▼             ▼
                   ┌─────────────────────────────┐
                   │     ADD TO ARRAY            │
                   │   UPDATE RANGE              │
                   │   CHECK FOR PATTERNS        │
                   └─────────────────────────────┘
```

### **Range Update Decision Tree**

```
                              🎯 RANGE UPDATE
                                       │
                                       ▼
                          ┌─────────────────────────┐
                          │   Current range state?  │
                          └─────────┬───────────────┘
                                    │
                     ┌──────────────┼──────────────┐
                     │              │              │
                     ▼              ▼              ▼
              ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
              │  {A, +∞}    │ │  {-∞, B}    │ │   {A, B}    │
              │ Looking H   │ │ Looking L   │ │  Complete   │
              └─────────────┘ └─────────────┘ └─────────────┘
                     │              │              │
                     ▼              ▼              ▼
              ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
              │New H found? │ │New L found? │ │BOS/ChoCH?   │
              └─────────────┘ └─────────────┘ └─────────────┘
                     │              │              │
              ┌──────┴──────┐ ┌──────┴──────┐ ┌──────┴──────┐
            YES│           │NO YES│        │NO YES│        │NO
              ▼           │   ▼           │   ▼           │
       ┌─────────────┐    │ ┌─────────────┐ │ ┌─────────────┐ │
       │Range = {A,H}│    │ │Range = {L,B}│ │ │Reset range  │ │
       └─────────────┘    │ └─────────────┘ │ │Start new    │ │
                          │                 │ └─────────────┘ │
                          ▼                 ▼                 ▼
                   ┌─────────────────────────────────────────────┐
                   │            CONTINUE MONITORING               │
                   └─────────────────────────────────────────────┘
```

---

## ⚙️ **IMPLEMENTATION FLOWCHART**

### **MT5 Implementation Steps**

```
┌─────────────────────────────────────────────────────────────────────┐
│                    🛠️ IMPLEMENTATION WORKFLOW                       │
└─────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
                        ┌───────────────────────┐
                        │   1. SETUP PHASE      │
                        │                       │
                        │ • Define structures   │
                        │ • Initialize arrays   │
                        │ • Set parameters      │
                        └─────────┬─────────────┘
                                  │
                                  ▼
                        ┌───────────────────────┐
                        │   2. DATA COLLECTION  │
                        │                       │
                        │ • OnCalculate() event │
                        │ • Candle close check  │
                        │ • Price data extract  │
                        └─────────┬─────────────┘
                                  │
                                  ▼
                        ┌───────────────────────┐
                        │   3. CORE PROCESSING  │
                        │                       │
                        │ • Swing detection     │
                        │ • Pattern analysis    │
                        │ • Structure events    │
                        └─────────┬─────────────┘
                                  │
                                  ▼
                        ┌───────────────────────┐
                        │   4. OUTPUT GENERATION│
                        │                       │
                        │ • Visual display      │
                        │ • Alerts/signals      │
                        │ • Data export         │
                        └─────────┬─────────────┘
                                  │
                                  ▼
                        ┌───────────────────────┐
                        │   5. OPTIMIZATION     │
                        │                       │
                        │ • Memory management   │
                        │ • Performance tuning  │
                        │ • Error handling      │
                        └───────────────────────┘
```

### **Error Handling Flowchart**

```
                            🚨 ERROR HANDLING
                                    │
                                    ▼
                        ┌───────────────────────┐
                        │   Error detected?     │
                        └─────────┬─────────────┘
                                  │
                           ┌──────┴──────┐
                         NO│            │YES
                           ▼            │
                    ┌─────────────┐      │
                    │  CONTINUE   │      │
                    │  NORMAL     │      │
                    │  OPERATION  │      │
                    └─────────────┘      │
                                         ▼
                        ┌───────────────────────┐
                        │   Classify error type │
                        └─────────┬─────────────┘
                                  │
                     ┌────────────┼────────────┐
                     │            │            │
                     ▼            ▼            ▼
              ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
              │    DATA     │ │   LOGIC     │ │   SYSTEM    │
              │   ERROR     │ │   ERROR     │ │   ERROR     │
              └─────────────┘ └─────────────┘ └─────────────┘
                     │            │            │
                     ▼            ▼            ▼
              ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
              │ • Log issue │ │ • Reset     │ │ • Graceful  │
              │ • Skip tick │ │   algorithm │ │   shutdown  │
              │ • Continue  │ │ • Restart   │ │ • Restart   │
              └─────────────┘ └─────────────┘ └─────────────┘
```

---

## 📊 **PERFORMANCE OPTIMIZATION FLOWCHART**

```
                          ⚡ PERFORMANCE OPTIMIZATION
                                       │
                                       ▼
                           ┌───────────────────────┐
                           │   Identify bottleneck │
                           └─────────┬─────────────┘
                                     │
                        ┌────────────┼────────────┐
                        │            │            │
                        ▼            ▼            ▼
                 ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
                 │   MEMORY    │ │     CPU     │ │   VISUAL    │
                 │  INTENSIVE  │ │  INTENSIVE  │ │  INTENSIVE  │
                 └─────────────┘ └─────────────┘ └─────────────┘
                        │            │            │
                        ▼            ▼            ▼
                 ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
                 │ • Circular  │ │ • Early     │ │ • Reduce    │
                 │   buffers   │ │   exits     │ │   drawings  │
                 │ • Array     │ │ • Cache     │ │ • Optimize  │
                 │   cleanup   │ │   results   │ │   refresh   │
                 └─────────────┘ └─────────────┘ └─────────────┘
                        │            │            │
                        └────────────┼────────────┘
                                     │
                                     ▼
                           ┌───────────────────────┐
                           │   Measure improvement │
                           │   Continue monitoring │
                           └───────────────────────┘
```

---

*"A clear flowchart is the roadmap to flawless algorithm execution."*
