# =========================================================
# PTG v4 ‚Äì BACKTEST LOG (manual)
# C√°ch d√πng:
#  - M·ªói l·∫ßn test, copy block "RUN BEGIN ‚Ä¶ RUN END" r·ªìi ƒëi·ªÅn s·ªë.
#  - Gi·ªØ nguy√™n c√°c KEY ƒë·ªÉ sau n√†y d·ªÖ ƒë·∫øm/t√¨m b·∫±ng find/regex.
#  - C√≥ 1 d√≤ng SUMMARY cu·ªëi block ƒë·ªÉ t·ªïng h·ª£p nhanh v√†o Excel.
# =========================================================

RUN BEGIN
RUN_ID:                                      [yyyy-mm-dd_hhmm_ucXX]          # v√≠ d·ª• 2025-09-12_2305_uc19
DATE_RANGE:                                  [2025-08-01 -> 2025-09-10]
SYMBOL:                                       XAUUSD
TIMEFRAME:                                    M1
USECASE:                                      [18|19|20..49]
BROKER:                                       [name/server n·∫øu c·∫ßn]
SPREAD_LIMITS:                                Max=[12]  LowVol=[10]
RN_FILTER:                                    [ON MajBuf=6 / MinBuf=4]        # ghi OFF n·∫øu t·∫Øt
BIAS:                                         [ON slope=35 contra=ON]         # ho·∫∑c OFF
SWEEP:                                        [Require=ON Soft=ON]            # ON hard/soft ho·∫∑c OFF
ATR_MIN_PIPS:                                 [50]
PUSH_RULE:                                    AvgATRmult=[0.60]  MaxATRmult=[0.80]
WICK_RULE:                                    Base=[0.35]  Alt=[0.18]  StrongATR=[0.35]  WickCap=[45p]
ENTRY_BUFFER_MODE:                            base=[3.0p] + dyn=[0.04*ATR + spread + 1.5]
ENGINE_INVALID:                               buf=[4p]+dyn  dwell=[10s]+dyn   rearm_window=[60s]
PENDING:                                      type=[Stop]   expiry=[120s]
EXITS_FLOORS:                                 BE=[14]  PARTIAL=[18]  TRAIL_START=[20]  TRAIL_STEP=[16]  EARLY_CUT=[12]
SL_MODE:                                      fixed=[25p]  atr_mult=[0.45]    # d√πng max v·ªõi n·∫Øp ATR

# -------- Strategy Tester Stats (ghi s·ªë) ----------
STATS.NET_PROFIT:                             []
STATS.PROFIT_FACTOR:                          []
STATS.SHARPE:                                 []
STATS.WINRATE_PCT:                            []
STATS.TOTAL_TRADES:                           []
STATS.LONGS/SHORTS:                           []
STATS.MAX_DD_ABS / REL%:                      [] / []
STATS.EXPECTANCY_PER_TRADE:                   []
STATS.AVG_TRADE_DURATION:                     []

# --------- Exit/Engine outcomes (ƒë·∫øm t·ª´ log) -----
COUNT.MOVE_BE:                                []
COUNT.PARTIAL_HIT:                            []
COUNT.TRAIL_HIT:                              []
COUNT.EARLY_CUT:                              []
COUNT.TIMESTOP:                               []

# --------- Filter/Block tallies (ƒë·∫øm t·ª´ log) -----
BLOCK.ROUND_NUMBER_NEARBY:                    []
BLOCK.SPREAD_TOO_WIDE:                         []
BLOCK.BIAS_GATE:                               []
BLOCK.PUSH_TOO_SMALL:                          []
BLOCK.WICK_TOO_SMALL:                          []
BLOCK.NO_SWEEP:                                []
CANCEL.STRUCTURE_INVALID:                      []
CANCEL.PENDING_EXPIRED:                        []
REARM.USED:                                    []

# --------- Ratios (t·ª± t√≠nh nhanh) ----------------
RATIO.EARLY_CUT_RATE = EARLY_CUT / EXECUTED_TRADES:         []
RATIO.CANCEL_RATE = (CANCEL.INVALID + CANCEL.EXPIRED) / SETUPS_SEEN: []
RATIO.BLOCKS_PER_SETUP = SUM(BLOCK.*)/SETUPS_SEEN:          []

# --------- Notes (ng·∫Øn g·ªçn, hi·ªán t∆∞·ª£ng ch√≠nh) -----
NOTES:
- [v√≠ d·ª•: nhi·ªÅu bias block ·ªü bi√™n RN; UC42 √≠t l·ªánh nh∆∞ng PF cao; UC45 gi·∫£m cancel r√µ r·ªát...]

# --------- SUMMARY (1 d√≤ng ƒë·ªÉ paste CSV/Excel) ---
SUMMARY: [DATE=2025-08-01..2025-09-10] [UC=19] [NP= ] [PF= ] [Sharpe= ] [WR%= ] [Trades= ] [DDabs= / DD%= ] [ECut= ] [Cancel= ] [BlocksRN/Spread/Bias= -/-/-]
RUN END

# ======= M·∫™U T√ìM T·∫ÆT TH√äM (tu·ª≥ ch·ªçn, 1 d√≤ng g·ªçn) =======
# CSV_HEADER (l∆∞u ri√™ng n·∫øu c·∫ßn): DateRange,Usecase,NetProfit,PF,Sharpe,WR,Trades,DDabs,DDpct,MoveBE,Partial,Trail,EarlyCut,TimeStop,BlockRN,BlockSpread,BlockBias,BlockPush,BlockWick,NoSweep,CancelInvalid,CancelExpired,Rearm
# CSV_EXAMPLE_ROW: 2025-08-01..2025-09-10,19,974,1.23,5.5,48.7,112, -320, -3.8, 26,19,12,14,6, 21,9,13,17,11,8, 24,5, 7



G·ª£i √Ω ƒë·∫øm nhanh (search keywords trong log debug)

MOVE_BE ‚Üí t√¨m üõ°Ô∏è Move BE

PARTIAL_HIT ‚Üí üí∞ Partial

TRAIL_HIT ‚Üí (kh√¥ng c√≥ emoji ri√™ng) ƒë·∫øm d√≤ng PositionModify tƒÉng SL khi pips ‚â• trail start ho·∫∑c th√™m th·ªß c√¥ng khi th·∫•y trailing.

EARLY_CUT ‚Üí ‚úÇÔ∏è Early-cut

TIMESTOP ‚Üí ‚èπ Time-stop

ROUND_NUMBER_NEARBY ‚Üí ‚ö†Ô∏è Round number nearby

SPREAD_TOO_WIDE ‚Üí ‚õî Spread too wide

BIAS_GATE ‚Üí ‚õî M5 bias filter

PUSH_TOO_SMALL ‚Üí ‚ö†Ô∏è PUSH too small

WICK_TOO_SMALL ‚Üí ‚ö†Ô∏è Wick too small

NO_SWEEP ‚Üí ‚ö†Ô∏è No sweep

CANCEL.INVALID ‚Üí üßπ Structure invalidated ‚Äì cancel pending

PENDING_EXPIRED ‚Üí ‚åõ Pending expired ‚Äì cancel

REARM.USED ‚Üí re-arm window (b·∫•t k·ª≥ d√≤ng c√≥ c·ª•m n√†y)

C·ª© l·∫•y file n√†y l√†m khung ‚Äî m·ªói l·∫ßn test ch·ªâ vi·ªác copy block RUN v√† ƒëi·ªÅn s·ªë. L√∫c c·∫ßn t·ªïng h·ª£p qua Excel, d√πng d√≤ng SUMMARY ho·∫∑c block CSV_EXAMPLE_ROW c·∫•u tr√∫c s·∫µn l√† xong. üöÄ